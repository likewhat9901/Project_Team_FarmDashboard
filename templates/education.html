<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/favicon.png') }}">
    <link rel="stylesheet" href="../static/css/ui_jk.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">
            <div class="logo-icon"></div>
        </div>
        
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="/dashboard" class="nav-link">
                    <span class="nav-icon">ğŸ </span>
                    ëŒ€ì‰¬ë³´ë“œ
                </a>
            </li>
            <li class="nav-item">
                <a href="/education" class="nav-link">
                    <span class="nav-icon">ğŸ«</span>
                    ë†ì—…êµìœ¡ê¸°ê´€
                </a>
            </li>
            <li class="nav-item">
                <a href="/flowershop" class="nav-link">
                    <span class="nav-icon">ğŸŒ¼</span>
                    ê½ƒì§‘ ì§€ë„
                </a>
            </li>
            <li class="nav-item">
                <a href="/growplant" class="nav-link">
                    <span class="nav-icon">
                        <img src="/static/images/growplant.png." alt="ì‹ë¬¼ ì„±ì¥ ì•„ì´ì½˜" style="width:21px; height:21px; vertical-align:middle;">
                    </span>
                    ì‹ë¬¼ ì„±ì¥ ì˜ˆì¸¡
                </a>
            </li>
            <li class="nav-item">
                <a href="/hurt" class="nav-link">
                    <span class="nav-icon">ğŸš‘</span>
                     ì‹ë¬¼ ë³‘ëª… ì§„ë‹¨
                </a>
            </li>
        </ul>

    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
            <h1 class="page-title">ë†ì—… êµìœ¡ ê¸°ê´€ğŸ«</h1>
        </div>

        <div class="iframe-container" style="height:85vh;">
            <iframe id="eduIframe" src="./static/iframes/edu_map_marker.html" width="100%" height="100%" frameborder="0"></iframe>
            <div id="searchContainer"></div>
        </div>
    </div>

    
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ -->
    <script>
        // ëª¨ë“  nav-link ìš”ì†Œ ì„ íƒ
        const navLinks = document.querySelectorAll('.nav-link');
        // í˜„ì¬ URL ê²½ë¡œ ì–»ê¸°
        const currentPath = window.location.pathname;

        navLinks.forEach(link => {
        const href = link.getAttribute('href');

        // hrefê°€ # ì´ê±°ë‚˜ ë¹ˆ ê°’ì´ë©´ ë¹„êµí•˜ì§€ ì•ŠìŒ
        if (!href || href === '#') return;

        const linkPath = new URL(href, window.location.origin).pathname;

        if (linkPath === currentPath) {
            link.classList.add('active');
        }
        });
    </script>

    <!-- ì„œì¹˜ ê¸°ëŠ¥ -->
    <!-- ì¹´ì¹´ì˜¤ ì£¼ì†Œ ê²€ìƒ‰ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <script>
        function openPostcodeSearch() {
            
            const postcode = new daum.Postcode({
                oncomplete: function(data) {
                    const selectedAddress = data.address;
                    console.log("ì„ íƒëœ ì£¼ì†Œ:", selectedAddress);

                    const kakaoMapUrl = "https://map.kakao.com/?q=" + encodeURIComponent(selectedAddress);
                    window.open(
                        kakaoMapUrl,
                        "_blank",
                        "width=1000,height=700,left=400,top=150,resizable=yes,scrollbars=yes"
                    );

                    // embed ëª¨ë“œì¼ ë•Œë§Œ close() í˜¸ì¶œ
                    if (typeof postcode.close === "function") {
                        postcode.close();
                    }

                    // embed()ë¡œ ë‹¤ì‹œ ë„ì›Œì•¼ ê°™ì€ ì£¼ì†Œë„ ë˜ ì„ íƒ ê°€ëŠ¥
                    setTimeout(() => {
                        openPostcodeSearch();
                    }, 500); // ì•½ê°„ì˜ ë”œë ˆì´ë¥¼ ì£¼ë©´ ë” ì•ˆì •ì 
                },
                width: "100%",
                height: "100%"
            });

            postcode.embed(document.getElementById("searchContainer"));
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°”ë¡œ ì‹¤í–‰
        window.onload = function() {
            openPostcodeSearch();
        };

    </script>

</body>
</html>